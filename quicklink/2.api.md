# 2.API

>  API

提交人:superxu[2848855]  
提交日期: 2023-04-09  
原文地址: https://wiki.torn.com/wiki/Stock_Market
内部超链接:
- 无
---

# 2.API

股市是你可以购买和出售各种股票的地方，用于投资利益块或投机交易。

## 详细内容

“API”是一个由Torn制作的新工具，你可以用来为Torn建立你自己的应用程序/扩展。本页的信息是直接从[API网站]("https://api.torn.com/")上复制的（信息是由分布在Torn的几个人添加的），所以在使用API之前，请确保仔细阅读它。

要开始使用API，请点击[这里]("https://api.torn.com/")，然后点击 "尝试 "按钮。然后你可以在顶部填写你的API密钥，这可以在[这个页面]("https://www.torn.com/preferences.php")找到。然后选择例如用户部分，填写你的ID和你选择的选项。

如果你不知道选择，而且它们没有显示在'试试'部分，你可以随时去http://api.torn.com/user/?selections=lookup&key=apikeyhere，看看可能的选择是什么。

### 介绍

首先，API代表什么？它是应用编程接口的意思。完整的定义可以在[这里]("https://en.wikipedia.org/wiki/Application_programming_interface")找到，但更重要的是它能做什么，你可以在本页面的细节部分找到。

Torn API的目标是为玩家提供一个完全支持和只读的方法，从Torn中提取关于他们的玩家、派系或公司的有用信息。这可以单独用于检索你的账户信息，或者你可以建立一个网站，让整个社区都可以使用通过API暴露的数据做一些有趣的事情。

### 潜在可能性  

无论你是做一个浏览器扩展来帮助战时的派别，还是做一个移动应用程序来提供即时通知，或者做一个网站来跟踪数据进行图表分析--可能性是无穷的--只需使用16个字符的API密钥。我们鼓励你发挥创造力，建立功能和工具，扩大《撕裂》的游戏性和乐趣。

## 用途 
这个系统的开发是为了让你只需要向用户请求一个API密钥。用户的所有信息都可以通过他们的密钥获得，不应该有任何要求询问姓名或用户ID。绝不应该向任何用户索取撕毁的密码，永远不应该。

你必须对钥匙以及从钥匙中获得的数据进行安全保护和保密，除非得到钥匙所有者的允许。通过接受其他用户的钥匙，他们对你的信任 - 不要利用这一点。我们将永久禁止违规的应用程序访问API，并随时通知。

我们恳请您在建设使用我们的API系统的网站或应用程序时，遵循Torn的无广告政策，以确保最佳的用户体验，但是，可以有例外。如果你想做广告，接受自愿的真金白银的捐赠或向用户收取使用费，请[联系我们]("api@torn.com")。

请确保你的脚本经过优化，只检索他们正在进行的特定请求所需的信息。他们应该尽可能少地检索信息；这将改善加载时间并减少Torn服务器的压力。

## 不公平的优势
我们理解，为Torn制作API系统可能会给一些用户带来不公平的优势。我们希望该系统能够扩展和增强游戏性，而不是给用户带来优势，使其更容易与他人竞争。我们在开发过程中已经考虑到了这一点，但我们将听取反馈意见，并做出任何必要的适当改变。

## 日志
请注意，我们会记录所有请求的细节和输入，并进行例行检查。如果发生滥用，我们将永久禁止IP地址、密钥和用户访问该系统，恕不另行通知。

## 限制和禁用
每个用户的钥匙每分钟最多可以发出100个单独的请求，这对于几乎任何事情都是可以实现的。使用无效密钥的多次请求可能会导致临时的IP禁止 - 你必须在出错时通过删除禁用或无效的密钥来说明这一点。

这些限制可能会改变，恕不另行通知，以确保Torn的服务器保持稳定。

## 访问等级
用户可以创建不同的密钥，以便在不同的脚本或工具中使用。用户可以持有10个不同级别的密钥来访问他们的播放器数据，每一个密钥都可以在用户需要的时候单独删除。每个访问级别对使用该钥匙的脚本所能获取的数据都有限制。

每个密钥有4个访问级别，即 "仅公开"、"最小访问"、"有限访问"、"完全访问"，密钥可以访问的信息可以在API文档中找到。

## 错误代码
0 => **Unknown error**：未处理的错误，不应该发生。

1 => **Key is empty** : 当前请求中的私钥为空。

2 => **Incorrect Key** : 私钥的格式错误/不正确。

3 => **Wrong type**：请求一个不正确的基本类型。

4 => **Wrong fields** : 请求不正确的选择字段。

5 => **Too many requests**：由于请求太多（每分钟最多100个），当前私钥在一小段时间内被禁止使用。

6 => **Incorrect ID** : 错误的ID值。

7 => **Incorrect ID-entity relation** : 请求的选择是私有的（例如，另一个用户/派别的个人数据）。

8 => **IP block** : 当前IP因为滥用而被禁止一小段时间。

9 => **API disabled** : API系统目前被禁用。

10 => **Key owner is in federal jail**：当前密钥不能使用，因为所有者在联邦监狱。

11 => **Key change error** : 你只能每60秒更改一次你的API密钥。

12 => **Key read error**：从数据库读取密钥时出错。

13 => **The key is temporarily disabled due to owner inactivity** : 一个不活跃的玩家的密钥在7天后可能无法进行API调用。

14 => **Daily read limit reached** : 该用户今天从我们的云服务中提取了太多的记录。

15 => **Temporary error**：一个专门用于测试的错误代码，没有专门的意义。

16 => **Access level of this key is not high enough** : 正在调用一个选择，这个键没有访问权限。


## 举例

Here there'll be short examples of code in several languages to see how you can use it.

JavaScript:
fetch("https://api.torn.com/user/?selections=skills&key=APIKEY") // Fetches data from API
.then((response) => response.json()) // Converts the fetched data into JSON
.then((jsonResponse) => console.log(jsonResponse)); // Prints the JSON

Python:
import requests

r = requests.get("apiurl") # queries "apiurl" and returns response from Torn

data = r.json()            # translates that response into a dict variable

print(data)                # prints that variable

PHP:
<?php
    $jsonurl = "http://api.torn.com/user/[MyID]?selections=networth&key=[MyKey]";
    $json = file_get_contents($jsonurl); //gets output of API
        
    $decodedString = json_decode($json, true); //parses API JSON output
    $nwtotal = $decodedString["networth"]; //Pulls networth out of JSON array
    echo "Stock Market: ".$nwtotal["stockmarket"]."</br>"; // Spits out networth from stocks
    echo "Networth Total: ".$nwtotal["total"]."</br>"; // Spits out total networth
?>
Safe to use applications
Here there'll be a list of well known safe to use applications that require your API:

Torn Stats, made by IceBlueFire
DoctorN, made by Mauk
TornTools, made by Mephiles
YATA, made by Kivou
Torn PDA, made by Manuito
This page was last edited on 3 November 2021, at 10:04.
Privacy policy About Torncity WIKI - The official help and support guide Disclaimers

## 参考链接
[↑](#cite_ref-1 ":id=cite_note-1") Chedburn, [Stocks 3.0]("https://www.torn.com/forums.php#/p=threads&amp;t=16220039")(06/04/21).
